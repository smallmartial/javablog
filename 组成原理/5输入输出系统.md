# 输入输出系统

## 1.概述

- 输入输出系统的发展

  - 早期 分散连接

  - 接口模块和DMA阶段

    - 总线连接

      ![image-20200416165211538](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416165211538.png)

  - 具有通道结构的阶段

  - 具有I/o处理机的阶段

- I/O软件

  - I/O指令
  - 通道指令

- I/O设备与主机的联系方式

  - I/O设备编码方式
    - 统一编址 用取数、存数操作
    - 不统一编址 有专用的I/O指令

- 设备选址

  - 用设备选择电路识别

- 传送方式

  - 串行
  - 并行

- 联络方式

  - 立即响应

  - 同步工作

  - 异步工作采用应答信号

    ![image-20200416174157056](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416174157056.png)

  

![image-20200416174218871](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416174218871.png)

- I/O设备与主机的连接方式

  - 辐射连接

    ![image-20200416174402533](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416174402533.png)

  - 总线连接

- I/O设备与主机传送的控制方式

  - 程序查询方式（cpu和IO串行工作）

    ![image-20200416174652967](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416174652967.png)

  - 程序中断方式（cpu和IO部分的并行工作）

    ![image-20200416175040136](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416175040136.png)

    ![image-20200416175256519](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416175256519.png)

  - DMA方式

    主存和I/O直接有一条直接的数据通道

    不中断现行的程序

    周期挪用

    ![image-20200416175710892](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416175710892.png)

- 三种效率比较

  ![image-20200416175908037](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416175908037.png)

  <img src="5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416180019406.png" alt="image-20200416180019406" style="zoom:150%;" />

## 2.外部（I/O）设备

- 概述

  ![image-20200416180205865](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416180205865.png)

  - 人机交互设备
  - 计算机信息存储设备
  - 机机通信设备

- 输入设备

  - 键盘
  - 鼠标
  - 触摸屏

- 输出设备

  - 显示器（字符、图形、图像）
  - 打印机

- 其他

  - AD DA
  - 终端
  - 汉字处理

- 多媒体设备

## 3.I/接口

- 概述

  - 实现设备的选择
  - 实现数据缓冲达到速度匹配
  - 实现数据串-并格式转化
  - 实现电平转换
  - 传送控制命令
  - 反应设备的状态

- 接口的功能和组成

  - 总线连线方式的I/O接口电路

    ![image-20200416181043758](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416181043758.png)

    ![image-20200416181346531](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416181346531.png)

    ![image-20200416181506170](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416181506170.png)

- 接口类型

  - 传送方式分类

    并行 串行

  - 选择的灵活性

    - 可编程接口
    - 不可编程接口

  - 通用性分类

    - 通用
    - 专用

  - 控制方式

    - 中断
    - DMA

## 4.程序查询方式

- 程序查询流程

  - 查询流程

    ![image-20200416182815677](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416182815677.png)

  - 程序流程

    ![image-20200416183945733](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416183945733.png)

  - 接口电路

    ![image-20200416184134712](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416184134712.png)

## 5.程序中断方式

- 概念

  ![image-20200416184457042](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416184457042.png)

- 中断的产生

  ![image-20200416184554582](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416184554582.png)

  - 程序中断方式的接口电路

    ![image-20200416184705951](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416184705951.png)

  - 中断向量地址形成部件

    - 入口地址（软件产生、硬件向量法）

     ![image-20200416185632011](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416185632011.png)

    ![image-20200416185728523](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416185728523.png)

- 中断接口电路的基本组成

  ![image-20200416185817085](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416185817085.png)

- IO中断处理过程

  - CPU响应中断的条件和时间

    ![image-20200416190101339](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416190101339.png)

  - 处理过程

- 中断服务程序的流程

  - 保护现场
    - 程序断点的保护
    - 寄存器内容的保护
  - 中断服务
  - 恢复现场
  - 中断返回

- 单重中断和多重中断

  ![image-20200416190844963](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416190844963.png)

  ![image-20200416191411964](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416191411964.png)

- 主程序和服务程序抢占CPU

  ![image-20200416191523492](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416191523492.png)

## 6.DMA方式

- 特点

  - DMA和程序中断两种方式的数据通路

    ![image-20200416191744287](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416191744287.png)

    

- DMA交互的三种方式

  - 停止CPU访问主存（控制简单）

  - 周期挪用

    ![image-20200416192153006](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416192153006.png)

  - DMA与CPU交替访问
  
- DMA接口的功能和组成

  - DMA接口功能

    ![image-20200416192454616](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416192454616.png)

  - DMA接口组成

    ![image-20200416192858843](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416192858843.png)

- DMA的工作过程

  - DMA传送过程

    ![image-20200416193220025](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416193220025.png)

    - 预处理

- DMA接口与系统的连接方式

  - 具有公共请求线的DMA请求

    ![image-20200416193633611](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416193633611.png)

  - 独立DMA请求

    ![image-20200416200838683](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416200838683.png)

  - DMA方式与程序中断方式比较

    ![image-20200416201025277](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416201025277.png)

- DMA接口类型

  - 选择型

    ![image-20200416201122877](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416201122877.png)

  - 多路型

    ![image-20200416201228533](5%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F/image-20200416201228533.png)

    

